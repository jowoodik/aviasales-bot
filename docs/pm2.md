# ๐ ะะฐะฟััะบ ะฟัะพะตะบัะฐ ัะตัะตะท PM2

## ะัััััะน ััะฐัั

### 1. ะฃััะฐะฝะพะฒะบะฐ PM2 (ะตัะปะธ ะตัะต ะฝะต ัััะฐะฝะพะฒะปะตะฝ)
```bash
npm install -g pm2
```

### 2. ะะฐะฟััะบ ะฒัะตั ะฟัะพัะตััะพะฒ
```bash
pm2 start ecosystem.config.js
```

### 3. ะัะพะฒะตัะบะฐ ััะฐัััะฐ
```bash
pm2 status
```

ะั ะดะพะปะถะฝั ัะฒะธะดะตัั 4 ะฟัะพัะตััะฐ:
- โ flyalert-bot        - Telegram ะฑะพั
- โ flyalert-scheduler  - ะัะพะฒะตัะบะฐ ะผะฐัััััะพะฒ
- โ flyalert-broadcast  - ะะฐััะพะฒะฐั ัะฐัััะปะบะฐ
- โ flyalert-web        - ะะตะฑ-ะฐะดะผะธะฝะบะฐ

---

## ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะพัะตััะฐะผะธ

### ะะฐะฟััะบ/ะพััะฐะฝะพะฒะบะฐ ะพัะดะตะปัะฝัั ะฟัะพัะตััะพะฒ
```bash
# ะะฐะฟััะบ
pm2 start ecosystem.config.js --only flyalert-bot
pm2 start ecosystem.config.js --only flyalert-scheduler
pm2 start ecosystem.config.js --only flyalert-broadcast
pm2 start ecosystem.config.js --only flyalert-web

# ะััะฐะฝะพะฒะบะฐ
pm2 stop flyalert-bot
pm2 stop flyalert-scheduler
pm2 stop flyalert-broadcast
pm2 stop flyalert-web

# ะะตัะตะทะฐะฟััะบ
pm2 restart flyalert-bot
pm2 restart flyalert-scheduler
pm2 restart flyalert-broadcast
pm2 restart flyalert-web
```

### ะััะฐะฝะพะฒะบะฐ/ะทะฐะฟััะบ ะฒัะตั ะฟัะพัะตััะพะฒ
```bash
pm2 stop all
pm2 restart all
pm2 delete all  # ะฃะดะฐะปะธัั ะฒัะต ะฟัะพัะตััั ะธะท PM2
```

---

## ะะพะณะธ

### ะัะพัะผะพัั ะปะพะณะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
```bash
# ะัะต ะฟัะพัะตััั
pm2 logs

# ะะพะฝะบัะตัะฝัะน ะฟัะพัะตัั
pm2 logs flyalert-bot
pm2 logs flyalert-scheduler
pm2 logs flyalert-broadcast
pm2 logs flyalert-web

# ะะพัะปะตะดะฝะธะต 100 ัััะพะบ
pm2 logs --lines 100

# ะก ัะธะปัััะฐัะธะตะน
pm2 logs flyalert-bot | grep "ERROR"
```

### ะคะฐะนะปั ะปะพะณะพะฒ
ะัะต ะปะพะณะธ ัะพััะฐะฝััััั ะฒ ะฟะฐะฟะบะต `./logs/`:
- `bot-error.log` / `bot-out.log` - ะพัะฝะพะฒะฝะพะน ะฑะพั
- `scheduler-error.log` / `scheduler-out.log` - ะฟัะพะฒะตัะบะฐ ะผะฐัััััะพะฒ
- `broadcast-error.log` / `broadcast-out.log` - ัะฐัััะปะบะฐ
- `web-error.log` / `web-out.log` - ะฒะตะฑ-ะฐะดะผะธะฝะบะฐ

### ะัะธััะบะฐ ะปะพะณะพะฒ
```bash
pm2 flush  # ะัะธััะธัั ะฒัะต ะปะพะณะธ
```

---

## ะะพะฝะธัะพัะธะฝะณ

### ะัะพัะผะพัั ััะฐัะธััะธะบะธ
```bash
# ะะฝัะตัะฐะบัะธะฒะฝัะน ะผะพะฝะธัะพัะธะฝะณ
pm2 monit

# ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะต
pm2 show flyalert-bot
pm2 show flyalert-scheduler
pm2 show flyalert-broadcast
pm2 show flyalert-web

# ะกะฟะธัะพะบ ะฟัะพัะตััะพะฒ ั ะฟะพััะตะฑะปะตะฝะธะตะผ ัะตััััะพะฒ
pm2 list
```

---

## ะะฒัะพะทะฐะฟััะบ ะฟัะธ ะฟะตัะตะทะฐะณััะทะบะต ัะตัะฒะตัะฐ

### 1. ะะฐัััะพะนะบะฐ ะฐะฒัะพะทะฐะฟััะบะฐ
```bash
pm2 startup
```

ะัะฟะพะปะฝะธัะต ะบะพะผะฐะฝะดั, ะบะพัะพััั ะฒัะฒะตะดะตั PM2.

### 2. ะกะพััะฐะฝะตะฝะธะต ัะตะบััะธั ะฟัะพัะตััะพะฒ
```bash
pm2 save
```

ะขะตะฟะตัั ะฒัะต ะฟัะพัะตััั ะฑัะดัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะฟััะบะฐัััั ะฟัะธ ะฟะตัะตะทะฐะณััะทะบะต ัะตัะฒะตัะฐ.

### 3. ะัะบะปััะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ
```bash
pm2 unstartup
```

---

## ะะฑะฝะพะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ

ะะพัะปะต ะธะทะผะตะฝะตะฝะธั `ecosystem.config.js`:

```bash
# ะะตัะตะทะฐะณััะทะธัั ะบะพะฝัะธะณััะฐัะธั
pm2 reload ecosystem.config.js

# ะะปะธ ัะดะฐะปะธัั ััะฐััะต ะฟัะพัะตััั ะธ ะทะฐะฟัััะธัั ะทะฐะฝะพะฒะพ
pm2 delete all
pm2 start ecosystem.config.js
pm2 save
```

---

## ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะต
pm2 info flyalert-bot

# ะะตัะตะทะฐะฟััะบ ั graceful shutdown
pm2 reload flyalert-bot

# ะััะฐะฝะพะฒะบะฐ ั graceful shutdown (ะพะถะธะดะฐะฝะธะต 5 ัะตะบัะฝะด)
pm2 stop flyalert-bot

# ะัะธะฝัะดะธัะตะปัะฝะฐั ะพััะฐะฝะพะฒะบะฐ
pm2 kill

# ะะฑะฝะพะฒะปะตะฝะธะต PM2
npm install -g pm2@latest
pm2 update
```

---

## Troubleshooting

### ะัะพัะตัั ะฟะพััะพัะฝะฝะพ ะฟะตัะตะทะฐะฟััะบะฐะตััั
```bash
# ะัะพะฒะตัััะต ะปะพะณะธ ะพัะธะฑะพะบ
pm2 logs flyalert-bot --err --lines 50

# ะัะพะฒะตัััะต ัะฐะนะป ะปะพะณะพะฒ
tail -n 100 ./logs/bot-error.log
```

### ะััะพะบะพะต ะฟะพััะตะฑะปะตะฝะธะต ะฟะฐะผััะธ
```bash
# ะัะพะฒะตัััะต ััะฐัะธััะธะบั
pm2 monit

# ะะตัะตะทะฐะฟัััะธัะต ะฟัะพัะตัั
pm2 restart flyalert-bot
```

### ะัะพัะตัั ะฝะต ะทะฐะฟััะบะฐะตััั
```bash
# ะัะพะฒะตัััะต ัะธะฝัะฐะบัะธั ะบะพะฝัะธะณััะฐัะธะธ
node ecosystem.config.js

# ะะฐะฟัััะธัะต ัะบัะธะฟั ะฝะฐะฟััะผัั ะดะปั ะฟัะพะฒะตัะบะธ
node index.js
node scheduler.js
node broadcast-scheduler.js
node web/server.js
```

---

## ะะตะบะพะผะตะฝะดัะตะผะฐั ะบะพะฝัะธะณััะฐัะธั

### ะะปั ัะฐะทัะฐะฑะพัะบะธ
```bash
# ะะฐะฟัััะธัั ัะพะปัะบะพ ะฑะพัะฐ ะธ ะฒะตะฑ-ะฐะดะผะธะฝะบั
pm2 start ecosystem.config.js --only flyalert-bot,flyalert-web

# ะััะฐะปัะฝัะต ะฟัะพัะตััั ะทะฐะฟััะบะฐัั ะฒัััะฝัั ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ
```

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ
```bash
# ะะฐะฟัััะธัั ะฒัะต ะฟัะพัะตััั
pm2 start ecosystem.config.js

# ะะฐัััะพะธัั ะฐะฒัะพะทะฐะฟััะบ
pm2 startup
pm2 save

# ะะพะฝะธัะพัะธะฝะณ
pm2 monit
```

---

## ะกัััะบัััะฐ ะฟัะพัะตััะพะฒ

```
โโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
โ ะัะพัะตัั             โ ะกะบัะธะฟั            โ ะะฐะผััั    โ ะะฐะทะฝะฐัะตะฝะธะต   โ
โโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโผโโโโโโโโโโโโโโโค
โ flyalert-bot       โ index.js          โ 1 GB      โ Telegram ะฑะพั โ
โ flyalert-scheduler โ scheduler.js      โ 500 MB    โ ะัะพะฒะตัะบะฐ     โ
โ flyalert-broadcast โ broadcast-sch...  โ 300 MB    โ ะะฐัััะปะบะฐ     โ
โ flyalert-web       โ web/server.js     โ 1 GB      โ ะะตะฑ-ะฐะดะผะธะฝะบะฐ  โ
โโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโโโโโ
```

---

*ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 03.02.2026*
